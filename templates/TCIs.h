#ifndef TCIs_H
#define TCIs_H

/**
 * I initially tried that these arrays are generated at compile-time and actually represent the hashes of the according components.
 * However, this turned out to be infeasible.
 * bl2 is somehow built twice during a normal build, which yields to inconsistent TCIs across the whole software system.
 * Depending on when the TCI.h generated and imported.
 *
 * For bl31 it would have been possible.
 *
 * The image of bl32 can't contain its own hash. Since you would need to build it first, then measure the hash, and finally inject the hash.
 * But because the injected data would change the image, the hash would change again.
 *
 * And, I didn't find a way to extract the TCI of the fTPM TA in the same way as the attestation PTA does it.
 * So, we need to boot, measure the fTPM and put the values here.
 * My ra_verifier tool outputs the FWIDs. You can copy paste it and generate this code here with:
 * echo "<copied FWID>" | xxd -r -p | xxd -i
 */

static const unsigned char tci_bl2[] = {0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
                                        0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,
                                        0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02};

static const unsigned char tci_bl31[] = {0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31,
                                         0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31,
                                         0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31, 0x31};

static const unsigned char tci_bl32[] = {0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32, 0x32};

static const unsigned char tci_ftpm[] = {0x8c, 0x95, 0x2f, 0x35, 0x52, 0x34, 0xe7, 0x8c, 0x79, 0x40, 0xb3, 0x0d, 0x62, 0x78, 0x55, 0x42, 0x1e, 0x10, 0x26, 0xd9, 0x7e, 0xc8, 0xf5, 0xaa, 0x0c, 0x51, 0x1d, 0x10, 0xb9, 0x48, 0x40, 0x92};

#endif /* TCIs_H */
